<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lender Intake Form - GrowWell Funding</title>
    <!-- All your style code here remains unchanged -->
    <!-- ... (keep your original <style> block intact) ... -->
    <!-- For brevity, not pasted here, but your posted CSS should remain at top of file -->
    <style>
        /* ... Your posted CSS here ... */
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üè¶ Lender Intake Form</h1>
            <p class="subtitle">Deep search company information for GrowWell Funding</p>
        </header>
        <!-- Info box removed per your request -->
        <div class="search-section">
            <div class="form-group">
                <label for="companyName">Company Name *</label>
                <input 
                    type="text" 
                    id="companyName" 
                    placeholder="Enter lender company name"
                    required
                />
            </div>
            <div class="form-group">
                <label for="companyWebsite">Company Website *</label>
                <input 
                    type="url" 
                    id="companyWebsite" 
                    placeholder="https://example.com"
                    required
                />
            </div>
            <button class="btn" id="searchBtn">
                üîç Search Lender Information
            </button>
        </div>
        <div class="error-message" id="errorMessage"></div>
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Analyzing company information...</p>
        </div>
        <div class="results-section" id="resultsSection">
            <h2 style="margin-bottom: var(--space-24); font-size: var(--font-size-2xl);">Lender Profile</h2>
            <div class="results-grid" id="resultsGrid"></div>
            <button class="btn export-btn" id="copyDataBtn">
                üìã Copy Data
            </button>
        </div>
    </div>
    <script>
        // --- Hunter.io integration function ---
        async function fetchHunterEmails(domain) {
            const apiKey = "870de4e4d43b6288789132642864f8fee24e0799";
            const url = `https://api.hunter.io/v2/domain-search?domain=${domain}&api_key=${apiKey}`;
            try {
                const response = await fetch(url);
                const data = await response.json();
                if (data && data.data && data.data.emails && data.data.emails.length > 0) {
                    const main = data.data.emails.find(e => e.type === "generic")
                        || data.data.emails.find(e => e.type === "personal")
                        || data.data.emails[0];
                    const secondary = data.data.emails.find(e => e.value !== main.value)
                        ? data.data.emails.find(e => e.value !== main.value).value
                        : "";
                    return { email: main.value, secondary };
                }
            } catch (err) {
                console.log("Hunter.io error:", err);
            }
            return { email: "", secondary: "" };
        }
        // --- End Hunter.io integration ---
        // The rest of your script with minor edits for integration:
        const ratingConfig = {
            'A': {
                color: '#10b981',
                description: 'Prime Lender - Traditional institution with strict criteria and best rates'
            },
            'B': {
                color: '#f59e0b',
                description: 'Alternative Lender - More flexible criteria for near-prime borrowers'
            },
            'C': {
                color: '#ea580c',
                description: 'Subprime Lender - Accepts borrowers with credit challenges'
            },
            'D': {
                color: '#ef4444',
                description: 'High-Risk Lender - Most lenient criteria, highest rates'
            }
        };
        const lenderFields = [
           { key: 'rating', label: 'Lender Rating', type: 'rating' },
           { key: 'companyName', label: 'Bank Name', type: 'text' },
           { key: 'website', label: 'Website', type: 'url' },
           { key: 'phone', label: 'Bank Main Phone', type: 'text' },
           { key: 'cityState', label: 'Bank City and State', type: 'text' },
           { key: 'contactName', label: 'Contact Name', type: 'text' },
           { key: 'contactEmail', label: 'Contact Email', type: 'text' },
           { key: 'secondaryEmail', label: 'Secondary Email', type: 'text' },
           { key: 'description', label: 'Short Description (About Us)', type: 'text' },
           { key: 'businessType', label: 'Type of Business', type: 'text' },
           { key: 'specialization', label: 'What Does the Lender Specialize In?', type: 'text' },
           { key: 'directLender', label: 'Direct Lender', type: 'badge' },
           { key: 'worksBrokers', label: 'Works With Brokers', type: 'badge' },
           { key: 'equipmentFinancing', label: 'Equipment Financing', type: 'badge' },
           { key: 'restaurantEquipment', label: 'Restaurant Equipment Financing', type: 'badge' },
           { key: 'furnitureFinancing', label: 'Furniture Financing', type: 'badge' },
           { key: 'hvacFinancing', label: 'HVAC Financing', type: 'badge' },
           { key: 'lineOfCredit', label: 'Line of Credit', type: 'badge' },
           { key: 'checkingAccounts', label: 'Do They Offer Checking Accounts?', type: 'badge' },
           { key: 'otherProducts', label: 'Other Product', type: 'text' },
           { key: 'approvalTime', label: 'Approval Timeframe', type: 'text' },
           { key: 'badCreditAccepted', label: 'Bad Credit Accepted', type: 'badge' },
           { key: 'minCreditScore', label: 'Minimum Credit Score', type: 'text' },
           { key: 'startupAccepted', label: 'Startup Accepted', type: 'badge' },
           { key: 'nonProfitAccepted', label: 'Non-Profit Accepted', type: 'badge' },
           { key: 'yearsRequired', label: 'Years in Business Required', type: 'text' },
           { key: 'revenueRequirements', label: 'Revenue Requirements', type: 'text' },
           { key: 'companySizeReqs', label: 'Company Size Requirements', type: 'text' },
           { key: 'lenderCount', label: 'How Many Other Lenders They Work With', type: 'text' }
        ];
        let currentLenderData = null;
        document.getElementById('searchBtn').addEventListener('click', performSearch);
        document.getElementById('copyDataBtn').addEventListener('click', copyDataToClipboard);
        document.getElementById('companyName').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') performSearch();
        });
        document.getElementById('companyWebsite').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') performSearch();
        });
        function performSearch() {
            const companyName = document.getElementById('companyName').value.trim();
            const companyWebsite = document.getElementById('companyWebsite').value.trim();
            const errorMessage = document.getElementById('errorMessage');
            const loading = document.getElementById('loading');
            const resultsSection = document.getElementById('resultsSection');
            errorMessage.classList.remove('active');
            resultsSection.classList.remove('active');
            if (!companyName || !companyWebsite) {
                showError('Please enter both company name and website.');
                return;
            }
            if (!isValidURL(companyWebsite)) {
                showError('Please enter a valid website (e.g., example.com, www.example.com, or https://example.com)');
                return;
            }
            loading.classList.add('active');
            setTimeout(async () => {
                let normalizedWebsite = companyWebsite;
                if (!companyWebsite.match(/^https?:\/\//i)) {
                    normalizedWebsite = 'https://' + companyWebsite;
                }
                const lenderData = simulateDeepSearch(companyName, normalizedWebsite);
                // --- Hunter.io Fetch Logic ---
                let domain = normalizedWebsite.replace(/^https?:\/\//, '').replace(/^www\./, '').replace(/\/.*$/, '');
                const emails = await fetchHunterEmails(domain);
                if (emails.email) lenderData.contactEmail = emails.email;
                if (emails.secondary) lenderData.secondaryEmail = emails.secondary;
                currentLenderData = lenderData;
                displayResults(lenderData);
                loading.classList.remove('active');
                resultsSection.classList.add('active');
            }, 500);
        }
        function isValidURL(string) {
            if (!string) return false;
            let urlToTest = string;
            if (!string.match(/^https?:\/\//i)) {
                urlToTest = 'https://' + string;
            }
            try {
                new URL(urlToTest);
                return true;
            } catch (_) {
                return false;
            }
        }
        function simulateDeepSearch(name, website) {
            // ... Your originally provided simulateDeepSearch function ...
            // (Leave this unchanged, see your earlier block)
            // ... keep all other helper functions/display logic as in your pasted code ...
            // ... (No further changes needed for Hunter integration) ...
            // The rest of your display, copy, rating, verification, etc. logic is unchanged.
            // (Omitted for brevity in this excerpt, as your complete code will be intact)
            // Be sure to copy your own implementation from your previous post here!
            // Only the performSearch and fetchHunterEmails function are new/changed.
        }
        // Continue the rest of your script unchanged...
    </script>
</body>
</html>
